<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<style>
    @page { size: A4; margin: 15mm 18mm; }
    body { font-family: 'Helvetica Neue', Arial, sans-serif; font-size: 10pt; color: #1a1a1a; line-height: 1.5; margin: 0; }
    .header { text-align: center; border-bottom: 3px solid #1e40af; padding-bottom: 12px; margin-bottom: 18px; }
    .header h1 { font-size: 15pt; margin: 0 0 2px; color: #1e40af; letter-spacing: 1px; }
    .header h2 { font-size: 10pt; margin: 0 0 4px; color: #444; font-weight: normal; }
    .header h3 { font-size: 12pt; margin: 8px 0 0; color: #1e40af; }
    .doc-meta { display: flex; justify-content: space-between; font-size: 8pt; color: #666; margin-bottom: 14px; }
    .doc-meta div { line-height: 1.6; }
    .info-box { background: #f0f5ff; border: 1px solid #bfdbfe; border-radius: 6px; padding: 10px 14px; margin-bottom: 14px; }
    .info-box table { width: 100%; }
    .info-box td { padding: 2px 0; font-size: 9.5pt; }
    .section-title { font-size: 10pt; font-weight: bold; color: #1e40af; margin: 16px 0 8px; padding-bottom: 4px; border-bottom: 1px solid #dbeafe; }
    .data-table { width: 100%; border-collapse: collapse; margin-bottom: 14px; }
    .data-table th { background: #1e40af; color: #fff; font-size: 8.5pt; text-transform: uppercase; padding: 7px 10px; text-align: left; }
    .data-table td { padding: 6px 10px; border-bottom: 1px solid #e5e7eb; font-size: 9.5pt; }
    .data-table tr:nth-child(even) td { background: #f9fafb; }
    .barang-table { width: 100%; border-collapse: collapse; margin-bottom: 14px; }
    .barang-table th { background: #dbeafe; color: #1e40af; font-size: 8.5pt; text-transform: uppercase; padding: 7px 8px; text-align: center; border: 1px solid #bfdbfe; }
    .barang-table td { padding: 6px 8px; border: 1px solid #e5e7eb; font-size: 9.5pt; }
    .signature-container { margin-top: 30px; }
    .sig-row { display: flex; justify-content: space-between; gap: 20px; }
    .sig-box { text-align: center; flex: 1; border: 1px solid #e5e7eb; border-radius: 8px; padding: 12px 10px; }
    .sig-box .sig-label { font-size: 8pt; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 50px; }
    .sig-box .sig-line { border-top: 2px solid #1e40af; margin: 0 20px; }
    .sig-box .sig-name { font-size: 9pt; font-weight: bold; margin-top: 6px; }
    .footer { text-align: center; font-size: 7.5pt; color: #9ca3af; margin-top: 20px; padding-top: 8px; border-top: 1px solid #e5e7eb; }
    .page-break { page-break-before: always; }
    .foto-box { border: 2px dashed #d1d5db; border-radius: 8px; padding: 12px; text-align: center; margin-top: 10px; }
    .foto-grid { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
    .foto-grid img { border-radius: 6px; object-fit: contain; }
    /* 1 photo: max 240px tall; 2 photos: side by side ~48%; 3+: smaller grid */
    .foto-1 img { max-width: 100%; max-height: 240px; }
    .foto-2 img { max-width: 48%; max-height: 200px; }
    .foto-3 img, .foto-4 img { max-width: 46%; max-height: 160px; }
    .foto-many img { max-width: 30%; max-height: 130px; }
    .badge { display: inline-block; padding: 2px 10px; border-radius: 10px; font-size: 8pt; font-weight: bold; }
    .badge-keluar { background: #fee2e2; color: #dc2626; }
    .badge-masuk { background: #dcfce7; color: #16a34a; }
</style>
</head>
<body>
<!-- PAGE 1 -->
<div class="header">
    <h1>PT PLN INDONESIA POWER</h1>
    <h2>Indonesia Power Integrated Management System</h2>
    <h3>SURAT IZIN {{ 'KELUAR' if surat.jenis == 'keluar' else 'MASUK' }} BARANG</h3>
</div>

<div class="doc-meta">
    <div><strong>No. Dokumen:</strong> ADP.17.01.015<br><strong>Revisi:</strong> 2</div>
    <div style="text-align:right"><strong>Tgl. Terbit:</strong> {{ surat.tgl_terbit }}<br><strong>Halaman:</strong> 1/2</div>
</div>

<div class="info-box">
    <table>
        <tr><td style="width:50%"><strong>No:</strong> {{ surat.no_surat }}</td><td style="text-align:right"><strong>Tanggal:</strong> {{ surat.tanggal }}</td></tr>
        <tr><td colspan="2"><strong>Divisi:</strong> {{ surat.divisi }} &nbsp; <span class="badge {{ 'badge-keluar' if surat.jenis=='keluar' else 'badge-masuk' }}">{{ surat.jenis | upper }}</span></td></tr>
    </table>
</div>

<p class="section-title">DATA PEMOHON</p>
<table class="data-table">
    <tr><td style="width:25%;font-weight:bold">NAMA</td><td>{{ surat.nama }}</td></tr>
    <tr><td style="font-weight:bold">BADGE</td><td>{{ surat.badge }}</td></tr>
    <tr><td style="font-weight:bold">NO KENDARAAN</td><td>{{ surat.no_kendaraan }}</td></tr>
    <tr><td style="font-weight:bold">PERUSAHAAN</td><td>{{ surat.perusahaan }}</td></tr>
    <tr><td style="font-weight:bold">NO SPK/MEMO</td><td>{{ surat.no_spk }}</td></tr>
</table>

<p style="font-size:9.5pt;margin:10px 0;">
    Untuk membawa barang {{ 'keluar dari' if surat.jenis == 'keluar' else 'masuk ke' }} PT Indonesia Power UBP Jawa Tengah 2 Adipala dengan rincian sebagai berikut:
</p>

<p class="section-title">DAFTAR BARANG</p>
<table class="barang-table">
    <thead><tr><th style="width:5%">NO</th><th style="width:25%">NAMA BARANG</th><th style="width:8%">JML</th><th style="width:8%">SATUAN</th><th style="width:18%">KETERANGAN</th><th style="width:18%">FOTO</th><th style="width:18%">CEK SATPAM</th></tr></thead>
    <tbody>
        {% for item in surat.barang_items %}
        <tr>
            <td style="text-align:center">{{ loop.index }}</td>
            <td>{{ item.nama_barang }}</td>
            <td style="text-align:center">{{ item.jumlah }}</td>
            <td style="text-align:center">{{ item.satuan }}</td>
            <td>{{ item.keterangan or '-' }}</td>
            <td style="text-align:center">
                {% if item.foto %}
                {% for f in item.foto %}
                <img src="file://{{ upload_dir }}/{{ f }}" style="max-height:40px;max-width:50px;border-radius:3px;margin:1px;" alt="">
                {% endfor %}
                {% else %}-{% endif %}
            </td>
            <td style="text-align:center">
                {% if item.approval_satpam == 'sesuai' %}
                <span style="color:#16a34a;font-weight:bold">✓ Sesuai</span>
                {% elif item.approval_satpam == 'tidak_sesuai' %}
                <span style="color:#dc2626;font-weight:bold">✗ Tidak</span>
                {% else %}-{% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="signature-container">
    <div class="sig-row">
        <div class="sig-box">
            <div class="sig-label">Pemohon</div>
            <div class="sig-line"></div>
            <div class="sig-name">{{ surat.pemohon }}</div>
        </div>
        <div class="sig-box">
            <div class="sig-label">Diperiksa Oleh</div>
            <div class="sig-line"></div>
            <div class="sig-name">{{ surat.diperiksa_oleh }}</div>
        </div>
        <div class="sig-box">
            <div class="sig-label">Disetujui Oleh</div>
            <div class="sig-line"></div>
            <div class="sig-name">{{ surat.disetujui_oleh }}</div>
        </div>
    </div>
</div>

<div class="footer">No. Dokumen: ADP.17.01.015 | Revisi: 2 | Tgl. Terbit: {{ surat.tgl_terbit }} | Halaman: 1/2</div>

<!-- PAGE 2 -->
<div class="page-break"></div>

<div class="header">
    <h1>PT PLN INDONESIA POWER</h1>
    <h2>Indonesia Power Integrated Management System</h2>
    <h3>SURAT IZIN {{ 'KELUAR' if surat.jenis == 'keluar' else 'MASUK' }} BARANG</h3>
</div>

<div class="doc-meta">
    <div><strong>No. Dokumen:</strong> ADP.17.01.015<br><strong>Revisi:</strong> 2</div>
    <div style="text-align:right"><strong>Tgl. Terbit:</strong> {{ surat.tgl_terbit }}<br><strong>Halaman:</strong> 2/2</div>
</div>

<div class="info-box">
    <table>
        <tr><td style="width:50%"><strong>No:</strong> {{ surat.no_surat }}</td><td style="text-align:right"><strong>Tanggal:</strong> {{ surat.tanggal }}</td></tr>
        <tr><td colspan="2"><strong>Divisi:</strong> {{ surat.divisi }}</td></tr>
    </table>
</div>

<p class="section-title">LAMPIRAN FOTO</p>
<div class="foto-box">
    {% if surat.foto_list %}
    {% set count = surat.foto_list|length %}
    <div class="foto-grid {{ 'foto-1' if count == 1 else ('foto-2' if count == 2 else ('foto-3' if count <= 4 else 'foto-many')) }}">
        {% for foto in surat.foto_list %}
        <img src="file://{{ upload_dir }}/{{ foto }}" alt="Lampiran {{ loop.index }}">
        {% endfor %}
    </div>
    {% else %}
    <p style="color:#999;margin-top:80px;font-size:9pt">Foto barang yang akan di{{ 'keluarkan' if surat.jenis=='keluar' else 'masukkan' }}</p>
    {% endif %}
</div>

<p class="section-title" style="margin-top:24px">CATATAN PENTING</p>
<div style="font-size:9pt;line-height:1.8;padding:10px 14px;background:#fffbeb;border:1px solid #fde68a;border-radius:6px;">
    <ol style="margin:0;padding-left:18px;">
        <li>Surat ini harus dibawa saat pengambilan/pengiriman barang</li>
        <li>Barang harus diperiksa oleh petugas keamanan sebelum {{ 'keluar' if surat.jenis=='keluar' else 'masuk' }}</li>
        <li>Tanda tangan dan stempel diperlukan untuk keabsahan surat</li>
        <li>Lampiran foto wajib dilengkapi sebagai bukti visual barang</li>
        <li>Surat ini berlaku hanya pada tanggal yang tercantum</li>
        <li>Barang yang {{ 'keluar' if surat.jenis=='keluar' else 'masuk' }} harus sesuai dengan daftar yang tercantum</li>
    </ol>
</div>

<div class="footer" style="margin-top:30px;">
    No. Dokumen: ADP.17.01.015 | Revisi: 2 | Tgl. Terbit: {{ surat.tgl_terbit }} | Halaman: 2/2<br>
    PT PLN Indonesia Power UBP Jawa Tengah 2 Adipala
</div>
</body>
</html>